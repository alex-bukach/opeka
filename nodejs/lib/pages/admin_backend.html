<!DOCTYPE html>
<html lang="en">
<head>
<title>nowjs test</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/nowjs/now.js"></script>

<script>
$(document).ready(function(){

  $("#createroom-button").click(function(){
	var roomName = $("#create-room-input").val();
    now.createRoom(roomName, 1);
    $("#create-room-input").val("");
    now.changeRoom(roomName);
	document.getElementById('current-room').innerHTML = "Your are in "+roomName;
  });

  function printElt(element, index, array) {
	  $("#rooms").append("<a href=\"#\" onClick=\"now.changeRoom($(this).text());\">"+element.name+"</a><br>");
  }

  now.receiveRooms = function(rooms){
	document.getElementById('rooms').innerHTML = "Room already created:<br>";
	if (rooms.length == 0)
		$("#rooms").append("No rooms available");
	else{
		rooms.forEach(printElt)
	}
  }

  now.receiveMessage = function(name, message){
    $("#messages").append("<br>" + name + ": " + message);
  }

  now.clearMessages = function(){
	document.getElementById('messages').innerHTML = "";	
  }
    
  $("#connect-button").click(function(){
	  now.name = $("#username-input").val()
      $("#username-input").val("");
	  now.newClientReady();
	  document.getElementById('connect').innerHTML = "";
	  document.getElementById('current-room').innerHTML = "You are connected now. Please create a room.";
  });

  $("#send-button").click(function(){
    now.distributeMessage($("#text-input").val());
    $("#text-input").val("");
  });

});
</script>
</head>

<body>

<div id="rooms">
</div>
<br>

<div id="current-room">
	You are not connected yet.
</div>
<br>

<div id="connect">
Username:
<input type="text" id="username-input">
<input type="button" value="Connect" id="connect-button"><br>
</div>
<br>

<div id="messages">
</div>
<br>

<input type="text" id="text-input">
<input type="button" value="Send" id="send-button">
<br>

Admin Commands:<br>
<input type="text" id="create-room-input">
<input type="button" value="Create Room" id="createroom-button"><br>

</body>
</html>